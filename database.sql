CREATE TABLE NHANVIEN (
    MANV VARCHAR2(5) PRIMARY KEY,
    TENNV VARCHAR2(30),
    GIOITINH VARCHAR2(5),
    NGAYSINH DATE,
    DIACHI VARCHAR2(50),
    SDT VARCHAR2(10), 
    LUONG FLOAT,
    PASSWORD VARCHAR2(10)
);
CREATE TABLE SANPHAM (
    MASP VARCHAR2(5) PRIMARY KEY,
    TENSP VARCHAR2(50),
    DVT VARCHAR2(20),
    GIABAN FLOAT,
    GIANHAP FLOAT,
    SLSP INT
);
CREATE TABLE KHACHHANG (
    MAKH VARCHAR2(5) PRIMARY KEY,
    TENKH VARCHAR2(30),
    GIOITINH VARCHAR2(5),
    NGAYSINH DATE
);
CREATE TABLE CHAMCONG (
    MACC VARCHAR2(5) PRIMARY KEY,
    MANV VARCHAR2(5),
    NGAYCC DATE,
    SOGIOLAM NUMBER,
    FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)
);

CREATE TABLE NHAPHANG (
    MANHAP VARCHAR2(5) PRIMARY KEY,
    MASP VARCHAR2(5),
    NGNHAP DATE,
    SLNHAP NUMBER,
    NHACC VARCHAR2(50),
    FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP)
);
CREATE TABLE HOADON (
    MAHD VARCHAR2(5) PRIMARY KEY,
    MANV VARCHAR2(5),
    NGAYHD DATE,
    MAKH VARCHAR2(15),
    TONGDT FLOAT,
    FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV),
    FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH)
);

CREATE TABLE KHUYENMAI (
    MAKM VARCHAR2(5) PRIMARY KEY,
    MASP VARCHAR2(5),
    CTKM VARCHAR2(50),
    CHIETKHAU FLOAT,
    NGAYBD DATE,
    NGAYKT DATE,
    FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP)
);
CREATE TABLE CTHD (
    MAHD VARCHAR2(5),
    MASP VARCHAR2(5),
    MAKM VARCHAR2(5),
    SL NUMBER,
    TRIGIA FLOAT,
    PRIMARY KEY (MAHD, MASP, MAKM),
    FOREIGN KEY (MAHD) REFERENCES HOADON(MAHD),
    FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP),
    FOREIGN KEY (MAKM) REFERENCES KHUYENMAI(MAKM)
);

CREATE TABLE DOANHTHU (
    NGAYLAP DATE PRIMARY KEY,
    TONGDT FLOAT
);

--- INIT SANPHAM AND KHUYENMAI
DECLARE
    v_sql VARCHAR2(1000);
BEGIN
    FOR rec IN (SELECT table_name FROM user_tables) LOOP
        v_sql := 'ALTER TABLE ' || rec.table_name || ' ADD isDeleted NUMBER(1) DEFAULT 0 NOT NULL';
        EXECUTE IMMEDIATE v_sql;
    END LOOP;
END;
/
INSERT INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP)
VALUES ('N/A', 'No Specific Product', 'unit', 0, 0, 0);
/

INSERT INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT)
VALUES ('N/A', 'N/A', 'No Promotion', 0, NULL, NULL);

INSERT INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES
('NV001', 'Nguyen Van A', 'Nam', TO_DATE('1985-01-01', 'YYYY-MM-DD'), 'Hanoi', '0901234567', 10.0, 'pass123');

INSERT INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES
('NV002', 'Tran Thi B', 'Nu', TO_DATE('1990-02-01', 'YYYY-MM-DD'), 'Hanoi', '0901234568', 12.0, 'pass124');

INSERT INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES
('NV003', 'Le Van C', 'Nam', TO_DATE('1988-03-01', 'YYYY-MM-DD'), 'Hanoi', '0901234569', 11.0, 'pass125');


INSERT ALL
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV004', 'Phan Thi D', 'Nu', TO_DATE('1992-04-01', 'YYYY-MM-DD'), 'Hanoi', '0901234570', 13.0, 'pass126')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV005', 'Hoang Van E', 'Nam', TO_DATE('1986-05-01', 'YYYY-MM-DD'), 'Hanoi', '0901234571', 10.0, 'pass127')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV006', 'Dang Thi F', 'Nu', TO_DATE('1995-06-01', 'YYYY-MM-DD'), 'Hanoi', '0901234572', 11.0, 'pass128')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV007', 'Nguyen Van G', 'Nam', TO_DATE('1987-07-01', 'YYYY-MM-DD'), 'Hanoi', '0901234573', 12.0, 'pass129')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV008', 'Tran Thi H', 'Nu', TO_DATE('1991-08-01', 'YYYY-MM-DD'), 'Hanoi', '0901234574', 13.0, 'pass130')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV009', 'Le Van I', 'Nam', TO_DATE('1984-09-01', 'YYYY-MM-DD'), 'Hanoi', '0901234575', 14.0, 'pass131')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV010', 'Pham Thi J', 'Nu', TO_DATE('1993-10-01', 'YYYY-MM-DD'), 'Hanoi', '0901234576', 14.0, 'pass132')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV011', 'Bui Van K', 'Nam', TO_DATE('1989-11-01', 'YYYY-MM-DD'), 'Hanoi', '0901234577', 15.0, 'pass133')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV012', 'Do Thi L', 'Nu', TO_DATE('1983-12-01', 'YYYY-MM-DD'), 'Hanoi', '0901234578', 15.0, 'pass134')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV013', 'Nguyen Van M', 'Nam', TO_DATE('1982-01-01', 'YYYY-MM-DD'), 'Hanoi', '0901234579', 16.0, 'pass135')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV014', 'Tran Thi N', 'Nu', TO_DATE('1996-02-01', 'YYYY-MM-DD'), 'Hanoi', '0901234580', 16.0, 'pass136')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV015', 'Le Van O', 'Nam', TO_DATE('1981-03-01', 'YYYY-MM-DD'), 'Hanoi', '0901234581', 17.0, 'pass137')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV016', 'Pham Thi P', 'Nu', TO_DATE('1994-04-01', 'YYYY-MM-DD'), 'Hanoi', '0901234582', 17.0, 'pass138')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV017', 'Bui Van Q', 'Nam', TO_DATE('1980-05-01', 'YYYY-MM-DD'), 'Hanoi', '0901234583', 18.0, 'pass139')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV018', 'Do Thi R', 'Nu', TO_DATE('1997-06-01', 'YYYY-MM-DD'), 'Hanoi', '0901234584', 18.0, 'pass140')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV019', 'Nguyen Van S', 'Nam', TO_DATE('1979-07-01', 'YYYY-MM-DD'), 'Hanoi', '0901234585', 19.0, 'pass141')
    INTO NHANVIEN (MANV, TENNV, GIOITINH, NGAYSINH, DIACHI, SDT, LUONG, PASSWORD) VALUES ('NV020', 'Tran Thi T', 'Nu', TO_DATE('1998-08-01', 'YYYY-MM-DD'), 'Hanoi', '0901234586', 19.0, 'pass142')
SELECT * FROM dual;

INSERT INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES
('SP001', 'San pham A', 'Cai', 2, 1, 400);

INSERT INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES
('SP002', 'San pham B', 'Chiec', 2.5, 2, 500);

INSERT INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES
('SP003', 'San pham C', 'Cai', 2.4, 2, 600);
INSERT ALL
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP004', 'San pham D', 'Chiec', 2, 1.5, 400)
    INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP005', 'San pham E', 'Cai', 2, 1, 500)
    INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP006', 'San pham F', 'Chiec', 2, 1.7, 600)
    INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP007', 'San pham G', 'Cai', 2.3, 1.4, 700)
    INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP008', 'San pham H', 'Chiec', 1.4, 1, 800)
    INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP009', 'San pham I', 'Cai', 1.4, 0.8, 900)
    INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP010', 'San pham J', 'Chiec', 2.3, 1.5, 1000)
    SELECT * FROM dual;
    INSERT ALL
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP011', 'San pham K', 'Cai', 2.9, 2.3, 500)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP012', 'San pham L', 'Chiec', 1.6, 1.1, 600)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP013', 'San pham M', 'Cai', 2.3, 1.8, 700)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP014', 'San pham N', 'Chiec', 2.1, 1.5, 800)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP015', 'San pham O', 'Cai', 2.8, 2.4, 900)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP016', 'San pham P', 'Chiec', 3.0, 2.6, 1000)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP017', 'San pham Q', 'Cai', 1.4, 0.9, 1100)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP018', 'San pham R', 'Chiec', 1.7, 1.3, 1200)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP019', 'San pham S', 'Cai', 2.2, 1.9, 1300)
INTO SANPHAM (MASP, TENSP, DVT, GIABAN, GIANHAP, SLSP) VALUES ('SP020', 'San pham T', 'Chiec', 2.6, 2.0, 1400)
SELECT * FROM DUAL;

INSERT INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES
('KH000', 'KH√ÅCH L?', 'Nam', '');

INSERT INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES
('KH001', 'Nguyen Van D', 'Nam', TO_DATE('1980-01-01', 'YYYY-MM-DD'));

INSERT INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES
('KH002', 'Tran Thi E', 'Nu', TO_DATE('1985-02-01', 'YYYY-MM-DD'));

INSERT INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES
('KH003', 'Le Van F', 'Nam', TO_DATE('1990-03-01', 'YYYY-MM-DD'));

INSERT ALL
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH004', 'Pham Van G', 'Nam', TO_DATE('1981-04-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH005', 'Le Thi H', 'Nu', TO_DATE('1986-05-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH006', 'Tran Van I', 'Nam', TO_DATE('1991-06-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH007', 'Hoang Thi J', 'Nu', TO_DATE('1993-07-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH008', 'Bui Van K', 'Nam', TO_DATE('1987-08-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH009', 'Dang Thi L', 'Nu', TO_DATE('1982-09-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH010', 'Nguyen Van M', 'Nam', TO_DATE('1994-10-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH011', 'Pham Thi N', 'Nu', TO_DATE('1983-11-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH012', 'Le Van O', 'Nam', TO_DATE('1995-12-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH013', 'Tran Thi P', 'Nu', TO_DATE('1988-01-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH014', 'Hoang Van Q', 'Nam', TO_DATE('1989-02-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH015', 'Bui Thi R', 'Nu', TO_DATE('1996-03-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH016', 'Dang Van S', 'Nam', TO_DATE('1997-04-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH017', 'Nguyen Thi T', 'Nu', TO_DATE('1984-05-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH018', 'Pham Van U', 'Nam', TO_DATE('1998-06-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH019', 'Le Thi V', 'Nu', TO_DATE('1985-07-01', 'YYYY-MM-DD'))
    INTO KHACHHANG (MAKH, TENKH, GIOITINH, NGAYSINH) VALUES ('KH020', 'Tran Van W', 'Nam', TO_DATE('1980-08-01', 'YYYY-MM-DD'))
SELECT * FROM dual;
INSERT INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC001', 'NV001', TO_DATE('2024-01-01', 'YYYY-MM-DD'), 8);
INSERT INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC002', 'NV002', TO_DATE('2024-01-02', 'YYYY-MM-DD'), 7);
INSERT INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC003', 'NV003', TO_DATE('2024-01-03', 'YYYY-MM-DD'), 6);

INSERT ALL
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC004', 'NV004', TO_DATE('2024-01-04', 'YYYY-MM-DD'), 8)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC005', 'NV005', TO_DATE('2024-01-05', 'YYYY-MM-DD'), 7)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC006', 'NV006', TO_DATE('2024-01-06', 'YYYY-MM-DD'), 6)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC007', 'NV007', TO_DATE('2024-01-07', 'YYYY-MM-DD'), 8)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC008', 'NV008', TO_DATE('2024-01-08', 'YYYY-MM-DD'), 7)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC009', 'NV009', TO_DATE('2024-01-09', 'YYYY-MM-DD'), 6)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC010', 'NV010', TO_DATE('2024-01-10', 'YYYY-MM-DD'), 8)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC011', 'NV011', TO_DATE('2024-01-11', 'YYYY-MM-DD'), 7)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC012', 'NV012', TO_DATE('2024-01-12', 'YYYY-MM-DD'), 6)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC013', 'NV013', TO_DATE('2024-01-13', 'YYYY-MM-DD'), 8)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC014', 'NV014', TO_DATE('2024-01-14', 'YYYY-MM-DD'), 7)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC015', 'NV015', TO_DATE('2024-01-15', 'YYYY-MM-DD'), 6)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC016', 'NV016', TO_DATE('2024-01-16', 'YYYY-MM-DD'), 8)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC017', 'NV017', TO_DATE('2024-01-17', 'YYYY-MM-DD'), 7)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC018', 'NV018', TO_DATE('2024-01-18', 'YYYY-MM-DD'), 6)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC019', 'NV019', TO_DATE('2024-01-19', 'YYYY-MM-DD'), 8)
    INTO CHAMCONG (MACC, MANV, NGAYCC, SOGIOLAM) VALUES ('CC020', 'NV020', TO_DATE('2024-01-20', 'YYYY-MM-DD'), 7)
SELECT * FROM dual;
INSERT ALL
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH001', 'SP001', TO_DATE('2024-01-01', 'YYYY-MM-DD'), 50, 'Nha cung cap A')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH002', 'SP002', TO_DATE('2024-01-02', 'YYYY-MM-DD'), 60, 'Nha cung cap B')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH003', 'SP003', TO_DATE('2024-01-03', 'YYYY-MM-DD'), 70, 'Nha cung cap C')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH004', 'SP004', TO_DATE('2024-01-04', 'YYYY-MM-DD'), 80, 'Nha cung cap D')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH005', 'SP005', TO_DATE('2024-01-05', 'YYYY-MM-DD'), 90, 'Nha cung cap E')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH006', 'SP006', TO_DATE('2024-01-06', 'YYYY-MM-DD'), 100, 'Nha cung cap F')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH007', 'SP007', TO_DATE('2024-01-07', 'YYYY-MM-DD'), 110, 'Nha cung cap G')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH008', 'SP008', TO_DATE('2024-01-08', 'YYYY-MM-DD'), 120, 'Nha cung cap H')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH009', 'SP009', TO_DATE('2024-01-09', 'YYYY-MM-DD'), 130, 'Nha cung cap I')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH010', 'SP010', TO_DATE('2024-01-10', 'YYYY-MM-DD'), 140, 'Nha cung cap J')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH011', 'SP011', TO_DATE('2024-01-11', 'YYYY-MM-DD'), 150, 'Nha cung cap K')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH012', 'SP012', TO_DATE('2024-01-12', 'YYYY-MM-DD'), 160, 'Nha cung cap L')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH013', 'SP013', TO_DATE('2024-01-13', 'YYYY-MM-DD'), 170, 'Nha cung cap M')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH014', 'SP014', TO_DATE('2024-01-14', 'YYYY-MM-DD'), 180, 'Nha cung cap N')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH015', 'SP015', TO_DATE('2024-01-15', 'YYYY-MM-DD'), 190, 'Nha cung cap O')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH016', 'SP016', TO_DATE('2024-01-16', 'YYYY-MM-DD'), 200, 'Nha cung cap P')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH017', 'SP017', TO_DATE('2024-01-17', 'YYYY-MM-DD'), 210, 'Nha cung cap Q')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH018', 'SP018', TO_DATE('2024-01-18', 'YYYY-MM-DD'), 220, 'Nha cung cap R')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH019', 'SP019', TO_DATE('2024-01-19', 'YYYY-MM-DD'), 230, 'Nha cung cap S')
INTO NHAPHANG (MANHAP, MASP, NGNHAP, SLNHAP, NHACC) VALUES ('NH020', 'SP020', TO_DATE('2024-01-20', 'YYYY-MM-DD'), 240, 'Nha cung cap T')
SELECT * FROM dual;
INSERT ALL
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD001', 'NV001', TO_DATE('2024-01-01', 'YYYY-MM-DD'), 'KH001')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD002', 'NV002', TO_DATE('2024-01-02', 'YYYY-MM-DD'), 'KH002')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD003', 'NV003', TO_DATE('2024-01-03', 'YYYY-MM-DD'), 'KH003')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD004', 'NV004', TO_DATE('2024-01-04', 'YYYY-MM-DD'), 'KH004')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD005', 'NV005', TO_DATE('2024-01-05', 'YYYY-MM-DD'), 'KH005')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD006', 'NV006', TO_DATE('2024-01-06', 'YYYY-MM-DD'), 'KH006')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD007', 'NV007', TO_DATE('2024-01-07', 'YYYY-MM-DD'), 'KH007')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD008', 'NV008', TO_DATE('2024-01-08', 'YYYY-MM-DD'), 'KH008')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD009', 'NV009', TO_DATE('2024-01-09', 'YYYY-MM-DD'), 'KH009')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD010', 'NV010', TO_DATE('2024-01-10', 'YYYY-MM-DD'), 'KH010')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD011', 'NV011', TO_DATE('2024-01-11', 'YYYY-MM-DD'), 'KH011')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD012', 'NV012', TO_DATE('2024-01-12', 'YYYY-MM-DD'), 'KH012')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD013', 'NV013', TO_DATE('2024-01-13', 'YYYY-MM-DD'), 'KH013')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD014', 'NV014', TO_DATE('2024-01-14', 'YYYY-MM-DD'), 'KH014')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD015', 'NV015', TO_DATE('2024-01-15', 'YYYY-MM-DD'), 'KH015')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD016', 'NV016', TO_DATE('2024-01-16', 'YYYY-MM-DD'), 'KH016')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD017', 'NV017', TO_DATE('2024-01-17', 'YYYY-MM-DD'), 'KH017')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD018', 'NV018', TO_DATE('2024-01-18', 'YYYY-MM-DD'), 'KH018')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD019', 'NV019', TO_DATE('2024-01-19', 'YYYY-MM-DD'), 'KH019')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD020', 'NV020', TO_DATE('2024-01-20', 'YYYY-MM-DD'), 'KH020')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD021', 'NV001', TO_DATE('2024-02-01', 'YYYY-MM-DD'), 'KH001')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD022', 'NV002', TO_DATE('2024-02-05', 'YYYY-MM-DD'), 'KH002')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD023', 'NV003', TO_DATE('2024-02-10', 'YYYY-MM-DD'), 'KH003')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD024', 'NV004', TO_DATE('2024-02-15', 'YYYY-MM-DD'), 'KH004')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD025', 'NV005', TO_DATE('2024-02-20', 'YYYY-MM-DD'), 'KH005')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD026', 'NV006', TO_DATE('2024-03-01', 'YYYY-MM-DD'), 'KH006')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD027', 'NV007', TO_DATE('2024-03-05', 'YYYY-MM-DD'), 'KH007')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD028', 'NV008', TO_DATE('2024-03-10', 'YYYY-MM-DD'), 'KH008')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD029', 'NV009', TO_DATE('2024-03-15', 'YYYY-MM-DD'), 'KH009')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD030', 'NV010', TO_DATE('2024-03-20', 'YYYY-MM-DD'), 'KH010')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD031', 'NV011', TO_DATE('2024-04-01', 'YYYY-MM-DD'), 'KH011')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD032', 'NV012', TO_DATE('2024-04-05', 'YYYY-MM-DD'), 'KH012')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD033', 'NV013', TO_DATE('2024-04-10', 'YYYY-MM-DD'), 'KH013')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD034', 'NV014', TO_DATE('2024-04-15', 'YYYY-MM-DD'), 'KH014')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD035', 'NV015', TO_DATE('2024-04-20', 'YYYY-MM-DD'), 'KH015')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD036', 'NV016', TO_DATE('2024-05-01', 'YYYY-MM-DD'), 'KH016')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD037', 'NV017', TO_DATE('2024-05-05', 'YYYY-MM-DD'), 'KH017')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD038', 'NV018', TO_DATE('2024-05-10', 'YYYY-MM-DD'), 'KH018')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD039', 'NV019', TO_DATE('2024-05-15', 'YYYY-MM-DD'), 'KH019')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD040', 'NV020', TO_DATE('2024-05-20', 'YYYY-MM-DD'), 'KH020')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD041', 'NV001', TO_DATE('2024-06-01', 'YYYY-MM-DD'), 'KH001')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD042', 'NV002', TO_DATE('2024-06-05', 'YYYY-MM-DD'), 'KH002')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD043', 'NV003', TO_DATE('2024-06-10', 'YYYY-MM-DD'), 'KH003')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD044', 'NV004', TO_DATE('2024-06-15', 'YYYY-MM-DD'), 'KH004')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD045', 'NV005', TO_DATE('2024-06-20', 'YYYY-MM-DD'), 'KH005')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD046', 'NV006', TO_DATE('2024-07-01', 'YYYY-MM-DD'), 'KH006')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD047', 'NV007', TO_DATE('2024-07-05', 'YYYY-MM-DD'), 'KH007')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD048', 'NV008', TO_DATE('2024-07-10', 'YYYY-MM-DD'), 'KH008')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD049', 'NV009', TO_DATE('2024-07-15', 'YYYY-MM-DD'), 'KH009')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD050', 'NV010', TO_DATE('2024-07-20', 'YYYY-MM-DD'), 'KH010')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD051', 'NV001', TO_DATE('2024-08-01', 'YYYY-MM-DD'), 'KH001')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD052', 'NV002', TO_DATE('2024-08-05', 'YYYY-MM-DD'), 'KH002')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD053', 'NV003', TO_DATE('2024-08-10', 'YYYY-MM-DD'), 'KH003')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD054', 'NV004', TO_DATE('2024-08-15', 'YYYY-MM-DD'), 'KH004')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD055', 'NV005', TO_DATE('2024-08-20', 'YYYY-MM-DD'), 'KH005')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD056', 'NV006', TO_DATE('2024-09-01', 'YYYY-MM-DD'), 'KH006')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD057', 'NV007', TO_DATE('2024-09-05', 'YYYY-MM-DD'), 'KH007')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD058', 'NV008', TO_DATE('2024-09-10', 'YYYY-MM-DD'), 'KH008')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD059', 'NV009', TO_DATE('2024-09-15', 'YYYY-MM-DD'), 'KH009')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD060', 'NV010', TO_DATE('2024-09-20', 'YYYY-MM-DD'), 'KH010')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD061', 'NV011', TO_DATE('2024-10-01', 'YYYY-MM-DD'), 'KH011')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD062', 'NV012', TO_DATE('2024-10-05', 'YYYY-MM-DD'), 'KH012')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD063', 'NV013', TO_DATE('2024-10-10', 'YYYY-MM-DD'), 'KH013')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD064', 'NV014', TO_DATE('2024-10-15', 'YYYY-MM-DD'), 'KH014')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD065', 'NV015', TO_DATE('2024-10-20', 'YYYY-MM-DD'), 'KH015')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD066', 'NV016', TO_DATE('2024-11-01', 'YYYY-MM-DD'), 'KH016')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD067', 'NV017', TO_DATE('2024-11-05', 'YYYY-MM-DD'), 'KH017')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD068', 'NV018', TO_DATE('2024-11-10', 'YYYY-MM-DD'), 'KH018')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD069', 'NV019', TO_DATE('2024-11-15', 'YYYY-MM-DD'), 'KH019')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD070', 'NV020', TO_DATE('2024-11-20', 'YYYY-MM-DD'), 'KH020')

INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD071', 'NV001', TO_DATE('2024-12-01', 'YYYY-MM-DD'), 'KH001')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD072', 'NV002', TO_DATE('2024-12-05', 'YYYY-MM-DD'), 'KH002')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD073', 'NV003', TO_DATE('2024-12-10', 'YYYY-MM-DD'), 'KH003')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD074', 'NV004', TO_DATE('2024-12-15', 'YYYY-MM-DD'), 'KH004')
INTO HOADON (MAHD, MANV, NGAYHD, MAKH) VALUES ('HD075', 'NV005', TO_DATE('2024-12-20', 'YYYY-MM-DD'), 'KH005')
SELECT * FROM dual;
INSERT ALL
INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT) VALUES ('KM001', 'SP001', 'Khuyen mai 10%', 0.1, TO_DATE('2024-01-01', 'YYYY-MM-DD'), TO_DATE('2024-01-31', 'YYYY-MM-DD'))
INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT) VALUES ('KM002', 'SP002', 'Khuyen mai 20%', 0.2, TO_DATE('2024-02-01', 'YYYY-MM-DD'), TO_DATE('2024-02-28', 'YYYY-MM-DD'))
INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT) VALUES ('KM003', 'SP003', 'Khuyen mai 30%', 0.3, TO_DATE('2024-03-01', 'YYYY-MM-DD'), TO_DATE('2024-03-31', 'YYYY-MM-DD'))
INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT) VALUES ('KM004', 'SP004', 'Khuyen mai 40%', 0.4, TO_DATE('2024-04-01', 'YYYY-MM-DD'), TO_DATE('2024-04-30', 'YYYY-MM-DD'))
INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT) VALUES ('KM005', 'SP005', 'Khuyen mai 50%', 0.5, TO_DATE('2024-05-01', 'YYYY-MM-DD'), TO_DATE('2024-05-31', 'YYYY-MM-DD'))
INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT) VALUES ('KM006', 'SP006', 'Khuyen mai 60%', 0.6, TO_DATE('2024-06-01', 'YYYY-MM-DD'), TO_DATE('2024-06-30', 'YYYY-MM-DD'))
INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT) VALUES ('KM007', 'SP007', 'Khuyen mai 70%', 0.7, TO_DATE('2024-07-01', 'YYYY-MM-DD'), TO_DATE('2024-07-31', 'YYYY-MM-DD'))
INTO KHUYENMAI (MAKM, MASP, CTKM, CHIETKHAU, NGAYBD, NGAYKT) VALUES ('KM008', 'SP008', 'Khuyen mai 80%', 0.8, TO_DATE('2024-08-01', 'YYYY-MM-DD'), TO_DATE('2024-08-31', 'YYYY-MM-DD'))
SELECT * FROM dual
INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD001', 'SP001', 'KM001', 20, 25)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD002', 'SP002', 'KM002', 5, 12)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD003', 'SP003', 'KM003', 5,14 )
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD004', 'SP004', 'KM004', 21, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD005', 'SP005', 'KM005', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD006', 'SP006', 'KM006', 23, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD007', 'SP007', 'KM007', 21, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD008', 'SP008', 'KM008', 38, 70)
SELECT * FROM dual;
select * from cthd
INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD001', 'SP004', 'KM004', 10, 15)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD001', 'SP002', 'KM002', 12, 20.0)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD001', 'SP003', 'KM003', 23, 46)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD001', 'SP005', 'KM005', 30, 70)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD001', 'SP006', 'KM001', 25, 68.0)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD002', 'SP007', 'KM002', 20, 40.0)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD002', 'SP008', 'KM003', 15, 45.0)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD002', 'SP009', 'KM004', 14, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD002', 'SP010', 'KM005', 18, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD002', 'SP011', 'KM003', 16, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD002', 'SP012', 'KM004', 17, 35)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD003', 'SP013', 'KM002', 10, 25)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD003', 'SP014', 'KM003', 22, 60)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD003', 'SP015', 'KM005', 26, 70)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD003', 'SP016', 'KM001', 28, 65)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD003', 'SP017', 'KM002', 24, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD003', 'SP018', 'KM003', 29, 55)
SELECT * FROM dual;

INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD021', 'SP001', 'KM001', 8, 18)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD021', 'SP002', 'KM002', 10, 23)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD021', 'SP003', 'KM003', 6, 12)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD021', 'SP004', 'KM004', 7, 15)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD021', 'SP005', 'KM005', 5, 11)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD022', 'SP006', 'KM001', 9, 20)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD022', 'SP007', 'KM002', 11, 25)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD022', 'SP008', 'KM003', 5, 10)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD022', 'SP009', 'KM004', 7, 16)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD022', 'SP010', 'KM005', 8, 18)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD023', 'SP011', 'KM001', 12, 26)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD023', 'SP012', 'KM002', 13, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD023', 'SP013', 'KM003', 5, 14)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD023', 'SP014', 'KM004', 7, 16)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD023', 'SP015', 'KM005', 9, 20)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD024', 'SP016', 'KM001', 8, 18)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD024', 'SP017', 'KM002', 10, 22)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD024', 'SP018', 'KM003', 6, 14)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD024', 'SP019', 'KM004', 7, 16)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD024', 'SP020', 'KM005', 5, 12)
SELECT * FROM dual;


INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD026', 'SP001', 'KM001', 30, 60)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD026', 'SP002', 'KM002', 35, 70)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD026', 'SP003', 'KM003', 25, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD026', 'SP004', 'KM004', 28, 56)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD026', 'SP005', 'KM005', 26, 52)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD027', 'SP006', 'KM001', 40, 80)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD027', 'SP007', 'KM002', 45, 90)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD027', 'SP008', 'KM003', 30, 60)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD027', 'SP009', 'KM004', 35, 70)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD027', 'SP010', 'KM005', 32, 64)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD028', 'SP011', 'KM001', 50, 100)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD028', 'SP012', 'KM002', 55, 110)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD028', 'SP013', 'KM003', 40, 80)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD028', 'SP014', 'KM004', 45, 90)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD028', 'SP015', 'KM005', 36, 72)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD029', 'SP016', 'KM001', 60, 120)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD029', 'SP017', 'KM002', 65, 130)
SELECT * FROM dual;


INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD031', 'SP001', 'KM001', 25, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD031', 'SP002', 'KM002', 28, 56)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD031', 'SP003', 'KM003', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD031', 'SP004', 'KM004', 22, 45)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD031', 'SP005', 'KM005', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD032', 'SP006', 'KM001', 30, 60)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD032', 'SP007', 'KM002', 32, 65)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD032', 'SP008', 'KM003', 23, 46)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD032', 'SP009', 'KM004', 25, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD032', 'SP010', 'KM005', 21, 42)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD033', 'SP011', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD033', 'SP012', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD033', 'SP013', 'KM003', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD033', 'SP014', 'KM004', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD033', 'SP015', 'KM005', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD034', 'SP016', 'KM001', 28, 56)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD034', 'SP017', 'KM002', 30, 60)
-- Insert other values for MASP SP018 to SP020
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD035', 'SP018', 'KM001', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD035', 'SP019', 'KM002', 26, 43)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD035', 'SP020', 'KM003', ?, ?)
SELECT * FROM dual;


INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD036', 'SP001', 'KM001', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD036', 'SP002', 'KM002', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD036', 'SP003', 'KM003', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD036', 'SP004', 'KM004', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD036', 'SP005', 'KM005', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD037', 'SP006', 'KM001', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD037', 'SP007', 'KM002', 26, 52)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD037', 'SP008', 'KM003', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD037', 'SP009', 'KM004', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD037', 'SP010', 'KM005', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD038', 'SP011', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD038', 'SP012', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD038', 'SP013', 'KM003', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD038', 'SP014', 'KM004', 19, 38)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD038', 'SP015', 'KM005', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD039', 'SP016', 'KM001', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD039', 'SP017', 'KM002', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD039', 'SP018', 'KM003', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD039', 'SP019', 'KM004', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD039', 'SP020', 'KM005', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD040', 'SP021', 'KM001', 25, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD040', 'SP022', 'KM002', 27, 54)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD040', 'SP023', 'KM003', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD040', 'SP024', 'KM004', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD040', 'SP025', 'KM005', 18, 36)
SELECT * FROM dual;


INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD041', 'SP001', 'KM001', 30, 60)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD041', 'SP002', 'KM002', 32, 65)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD041', 'SP003', 'KM003', 23, 46)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD041', 'SP004', 'KM004', 25, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD041', 'SP005', 'KM005', 21, 42)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD042', 'SP006', 'KM001', 25, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD042', 'SP007', 'KM002', 27, 54)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD042', 'SP008', 'KM003', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD042', 'SP009', 'KM004', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD042', 'SP010', 'KM005', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD043', 'SP011', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD043', 'SP012', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD043', 'SP013', 'KM003', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD043', 'SP014', 'KM004', 19, 38)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD043', 'SP015', 'KM005', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD044', 'SP016', 'KM001', 28, 56)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD044', 'SP017', 'KM002', 30, 60)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD044', 'SP018', 'KM003', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD044', 'SP019', 'KM004', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD044', 'SP020', 'KM005', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD045', 'SP021', 'KM001', 25, 50)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD045', 'SP022', 'KM002', 27, 54)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD045', 'SP023', 'KM003', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD045', 'SP024', 'KM004', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD045', 'SP025', 'KM005', 18, 36)
SELECT * FROM dual;


INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD046', 'SP001', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD046', 'SP002', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD046', 'SP003', 'KM003', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD046', 'SP004', 'KM004', 19, 38)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD046', 'SP005', 'KM005', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD047', 'SP006', 'KM001', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD047', 'SP007', 'KM002', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD047', 'SP008', 'KM003', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD047', 'SP009', 'KM004', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD047', 'SP010', 'KM005', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD048', 'SP011', 'KM001', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD048', 'SP012', 'KM002', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD048', 'SP013', 'KM003', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD048', 'SP014', 'KM004', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD048', 'SP015', 'KM005', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD049', 'SP016', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD049', 'SP017', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD049', 'SP018', 'KM003', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD049', 'SP019', 'KM004', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD049', 'SP020', 'KM005', 16, 32)
SELECT * FROM dual;

INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD051', 'SP001', 'KM001', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD051', 'SP002', 'KM002', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD051', 'SP003', 'KM003', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD051', 'SP004', 'KM004', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD051', 'SP005', 'KM005', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD052', 'SP006', 'KM001', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD052', 'SP007', 'KM002', 26, 52)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD052', 'SP008', 'KM003', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD052', 'SP009', 'KM004', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD052', 'SP010', 'KM005', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD053', 'SP011', 'KM001', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD053', 'SP012', 'KM002', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD053', 'SP013', 'KM003', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD053', 'SP014', 'KM004', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD053', 'SP015', 'KM005', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD054', 'SP016', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD054', 'SP017', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD054', 'SP018', 'KM003', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD054', 'SP019', 'KM004', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD054', 'SP020', 'KM005', 14, 28)
SELECT * FROM dual;


INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD056', 'SP191', 'KM001', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD056', 'SP192', 'KM002', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD056', 'SP193', 'KM003', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD056', 'SP194', 'KM004', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD056', 'SP195', 'KM005', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD057', 'SP196', 'KM001', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD057', 'SP197', 'KM002', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD057', 'SP198', 'KM003', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD057', 'SP199', 'KM004', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD057', 'SP200', 'KM005', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD058', 'SP201', 'KM001', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD058', 'SP202', 'KM002', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD058', 'SP203', 'KM003', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD058', 'SP204', 'KM004', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD058', 'SP205', 'KM005', 10, 20)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD059', 'SP206', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD059', 'SP207', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD059', 'SP208', 'KM003', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD059', 'SP209', 'KM004', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD059', 'SP210', 'KM005', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD060', 'SP211', 'KM001', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD060', 'SP212', 'KM002', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD060', 'SP213', 'KM003', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD060', 'SP214', 'KM004', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD060', 'SP215', 'KM005', 18, 36)
SELECT * FROM dual;


INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD061', 'SP001', 'KM001', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD061', 'SP002', 'KM002', 26, 52)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD061', 'SP003', 'KM003', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD061', 'SP004', 'KM004', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD061', 'SP005', 'KM005', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD062', 'SP006', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD062', 'SP007', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD062', 'SP008', 'KM003', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD062', 'SP009', 'KM004', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD062', 'SP010', 'KM005', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD063', 'SP011', 'KM001', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD063', 'SP012', 'KM002', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD063', 'SP013', 'KM003', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD063', 'SP014', 'KM004', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD063', 'SP015', 'KM005', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD064', 'SP016', 'KM001', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD064', 'SP017', 'KM002', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD064', 'SP018', 'KM003', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD064', 'SP019', 'KM004', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD064', 'SP020', 'KM005', 18, 36)
SELECT * FROM dual;



INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD066', 'SP001', 'KM001', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD066', 'SP002', 'KM002', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD066', 'SP003', 'KM003', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD066', 'SP004', 'KM004', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD066', 'SP005', 'KM005', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD067', 'SP006', 'KM001', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD067', 'SP007', 'KM002', 24, 48)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD067', 'SP008', 'KM003', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD067', 'SP009', 'KM004', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD067', 'SP010', 'KM005', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD068', 'SP011', 'KM001', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD068', 'SP012', 'KM002', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD068', 'SP013', 'KM003', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD068', 'SP014', 'KM004', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD068', 'SP015', 'KM005', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD069', 'SP016', 'KM001', 20, 40)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD069', 'SP017', 'KM002', 22, 44)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD069', 'SP018', 'KM003', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD069', 'SP019', 'KM004', 17, 34)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD069', 'SP020', 'KM005', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD070', 'SP021', 'KM001', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD070', 'SP022', 'KM002', 18, 36)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD070', 'SP023', 'KM003', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD070', 'SP024', 'KM004', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD070', 'SP025', 'KM005', 10, 20)
SELECT * FROM dual;


INSERT ALL
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD071', 'SP001', 'KM001', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD071', 'SP002', 'KM002', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD071', 'SP003', 'KM003', 9, 18)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD071', 'SP004', 'KM004', 11, 22)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD071', 'SP005', 'KM005', 8, 16)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD072', 'SP006', 'KM001', 14, 28)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD072', 'SP007', 'KM002', 16, 32)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD072', 'SP008', 'KM003', 10, 20)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD072', 'SP009', 'KM004', 12, 24)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD072', 'SP010', 'KM005', 9, 18)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD073', 'SP011', 'KM001', 11, 22)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD073', 'SP012', 'KM002', 13, 26)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD073', 'SP013', 'KM003', 8, 16)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD073', 'SP014', 'KM004', 10, 20)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD073', 'SP015', 'KM005', 7, 14)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD074', 'SP016', 'KM001', 13, 26)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD074', 'SP017', 'KM002', 15, 30)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD074', 'SP018', 'KM003', 9, 18)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD074', 'SP019', 'KM004', 11, 22)
INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA) VALUES ('HD074', 'SP020', 'KM005', 8, 16)
SELECT * FROM dual;;

INSERT ALL
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-01', 'YYYY-MM-DD'), 1800.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-02', 'YYYY-MM-DD'), 1200.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-03', 'YYYY-MM-DD'), 1960.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-04', 'YYYY-MM-DD'), 1600.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-05', 'YYYY-MM-DD'), 2500.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-06', 'YYYY-MM-DD'), 3600.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-07', 'YYYY-MM-DD'), 4900.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-08', 'YYYY-MM-DD'), 6400.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-09', 'YYYY-MM-DD'), 8100.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-10', 'YYYY-MM-DD'), 10000.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-11', 'YYYY-MM-DD'), 12100.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-12', 'YYYY-MM-DD'), 14400.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-13', 'YYYY-MM-DD'), 16900.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-14', 'YYYY-MM-DD'), 19600.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-15', 'YYYY-MM-DD'), 22500.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-16', 'YYYY-MM-DD'), 25600.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-17', 'YYYY-MM-DD'), 28900.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-18', 'YYYY-MM-DD'), 32400.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-19', 'YYYY-MM-DD'), 36100.0)
INTO DOANHTHU (NGAYLAP, TONGDT) VALUES (TO_DATE('2024-01-20', 'YYYY-MM-DD'), 40000.0)
SELECT * FROM dual;

---CheckSP
CREATE OR REPLACE TRIGGER trg_check_gia_ban
BEFORE INSERT OR UPDATE ON SANPHAM
FOR EACH ROW
BEGIN
  IF :NEW.GIABAN <= :NEW.GIANHAP THEN
    RAISE_APPLICATION_ERROR(-20001, 'Gi√° b√°n ph?i l?n h?n gi√° nh?p.');
  END IF;
END;
/


--- trigger ch?m c√¥ng
CREATE OR REPLACE TRIGGER TRG_INSERT_CHAMCONG
BEFORE INSERT ON CHAMCONG
FOR EACH ROW
DECLARE
    v_new_ma_cc VARCHAR2(5);
BEGIN
    SELECT 'CC' || LPAD(NVL(MAX(SUBSTR(MACC, 3)), 0) + 1, 3, '0')
    INTO v_new_ma_cc
    FROM CHAMCONG;
    :NEW.MACC := v_new_ma_cc;
END;
/

--- trigger h√≥a ?on
CREATE OR REPLACE TRIGGER TRG_INSERT_HOADON
BEFORE INSERT ON HOADON
FOR EACH ROW
DECLARE
    v_new_ma_hd VARCHAR2(5);
BEGIN
    -- T√¨m m√£ h√≥a ??n m?i nh?t
    SELECT 'HD' || LPAD(NVL(MAX(SUBSTR(MAHD, 3)), 0) + 1, 3, '0')
    INTO v_new_ma_hd
    FROM HOADON;

    -- G√°n m√£ h√≥a ??n m?i v√†o tr??ng MAHD c?a h√†ng m?i
    :NEW.MAHD := v_new_ma_hd;
END;
/

--- trigger kh√°ch h√†ng
create or replace TRIGGER TRG_INSERT_KHACHHANG
BEFORE INSERT ON KHACHHANG
FOR EACH ROW
DECLARE
    v_new_ma_kh VARCHAR2(5);
BEGIN
    -- T√¨m m√£ kh√°ch h√†ng m?i nh?t
    SELECT 'KH' || LPAD(NVL(MAX(SUBSTR(MAKH, 3)), 0) + 1, 3, '0')
    INTO v_new_ma_kh
    FROM KHACHHANG;

    -- G√°n m√£ kh√°ch h√†ng m?i v√†o tr??ng MAKH c?a h√†ng m?i
    :NEW.MAKH := v_new_ma_kh;
END;
/

--- trigger khuy?n m√£i
CREATE OR REPLACE TRIGGER TRG_INSERT_KHUYENMAI
BEFORE INSERT ON KHUYENMAI
FOR EACH ROW
DECLARE
    v_new_ma_km VARCHAR2(5);
    v_max_num NUMBER;
BEGIN
    SELECT MAX(TO_NUMBER(SUBSTR(MAKM, 3)))
    INTO v_max_num
    FROM KHUYENMAI
    WHERE REGEXP_LIKE(MAKM, '^KM[0-9]{3}$');

    IF v_max_num IS NULL THEN
        v_max_num := 1;
    ELSE
        v_max_num := v_max_num + 1;
    END IF;

    v_new_ma_km := 'KM' || LPAD(v_max_num, 3, '0');
    :NEW.MAKM := v_new_ma_km;
END;
/

--- trigger nh√¢n vi√™n
CREATE OR REPLACE TRIGGER TRG_INSERT_NHANVIEN
BEFORE INSERT ON NHANVIEN
FOR EACH ROW
DECLARE
    v_new_ma_nv VARCHAR2(5);
BEGIN
    SELECT 'NV' || LPAD(NVL(MAX(SUBSTR(MANV, 3)), 0) + 1, 3, '0')
    INTO v_new_ma_nv
    FROM NHANVIEN;
    :NEW.MANV := v_new_ma_nv;
END;
/


--- trigger nhaphang
CREATE OR REPLACE TRIGGER TRG_INSERT_NHAPHANG
BEFORE INSERT ON NHAPHANG
FOR EACH ROW
DECLARE
    v_new_ma_nhap VARCHAR2(5);
BEGIN
    SELECT 'NH' || LPAD(NVL(MAX(SUBSTR(MANHAP, 3)), 0) + 1, 3, '0')
    INTO v_new_ma_nhap
    FROM NHAPHANG;
    :NEW.MANHAP := v_new_ma_nhap;
END;
/

--- trigger s?n ph?m
CREATE OR REPLACE TRIGGER TRG_INSERT_SANPHAM
BEFORE INSERT ON SANPHAM
FOR EACH ROW
DECLARE
    v_new_ma_sp VARCHAR2(5);
    v_max_num NUMBER;
BEGIN
    -- L?y gi√° tr? s? l?n nh?t t? c?t MASP c√≥ ??nh d?ng SPxxx
    SELECT MAX(TO_NUMBER(SUBSTR(MASP, 3)))
    INTO v_max_num
    FROM SANPHAM
    WHERE REGEXP_LIKE(MASP, '^SP[0-9]{3}$');

    -- N?u kh√¥ng c√≥ gi√° tr? n√†o th?a m√£n, b?t ??u t? 1
    IF v_max_num IS NULL THEN
        v_max_num := 1;
    ELSE
        v_max_num := v_max_num + 1;
    END IF;

    -- T?o m√£ s?n ph?m m?i v?i ??nh d?ng SPxxx
    v_new_ma_sp := 'SP' || LPAD(v_max_num, 3, '0');
    :NEW.MASP := v_new_ma_sp;
END;
/

--- trigger ngkt
CREATE OR REPLACE TRIGGER trg_ngkt
BEFORE INSERT OR UPDATE ON KHUYENMAI 
FOR EACH ROW
BEGIN
    IF :NEW.NGAYKT <= :NEW.NGAYBD THEN
        RAISE_APPLICATION_ERROR(-20003, 'Ngay ket thuc phai lon hon ngay bat dau');
    END IF;
END;
/
ALTER TABLE KHUYENMAI
ADD CONSTRAINT ck_chietkhau CHECK (CHIETKHAU >= 0 AND CHIETKHAU < 1);


----trigger checkone
CREATE OR REPLACE TRIGGER trg_check_one_promotion
FOR INSERT OR UPDATE ON KHUYENMAI
COMPOUND TRIGGER

    TYPE PromotionRecType IS RECORD (
        MASP KHUYENMAI.MASP%TYPE,
        MAKM KHUYENMAI.MAKM%TYPE,
        NGAYBD KHUYENMAI.NGAYBD%TYPE,
        NGAYKT KHUYENMAI.NGAYKT%TYPE
    );
    TYPE PromotionTableType IS TABLE OF PromotionRecType;
    g_new_promotions PromotionTableType := PromotionTableType();  -- Khai b√°o bi?n

    BEFORE EACH ROW IS
    BEGIN
        IF :NEW.isDeleted = 0 THEN  -- Ch? ki?m tra khi khuy?n m√£i kh√¥ng b? x√≥a
            -- Ki?m tra tr√πng l?p khuy?n m√£i
            DECLARE
                v_count INTEGER;
            BEGIN
                SELECT COUNT(*) INTO v_count
                FROM KHUYENMAI
                WHERE MASP = :NEW.MASP
                  AND isDeleted = 0
                  AND (
                    (:NEW.NGAYBD BETWEEN NGAYBD AND NGAYKT) OR
                    (:NEW.NGAYKT BETWEEN NGAYBD AND NGAYKT) OR
                    (NGAYBD BETWEEN :NEW.NGAYBD AND :NEW.NGAYKT) OR
                    (NGAYKT BETWEEN :NEW.NGAYBD AND :NEW.NGAYKT)
                  );

                IF v_count > 0 THEN
                    RAISE_APPLICATION_ERROR(-20001, 'M?t s?n ph?m ch? c√≥ th? c√≥ m?t khuy?n m√£i ho?t ??ng t?i m?t th?i ?i?m.');
                END IF;
            END;

            -- Ki?m tra ng√†y k?t th√∫c khuy?n m√£i
            IF :NEW.NGAYKT < SYSDATE THEN
                RAISE_APPLICATION_ERROR(-20002, 'Ng√†y k?t th√∫c khuy?n m√£i kh√¥ng th? n?m trong qu√° kh?.');
            END IF;
        END IF;
    END BEFORE EACH ROW;
END trg_check_one_promotion;
/
--- trigger slsp
CREATE OR REPLACE TRIGGER trg_slsp
AFTER INSERT OR UPDATE ON NHAPHANG
FOR EACH ROW
DECLARE
    v_sl_nhap NUMBER;
BEGIN
    -- L?y s? l??ng nh?p t? h√†ng m?i
    v_sl_nhap := :NEW.SLNHAP;

    -- C?p nh?t SLSP trong SANPHAM (n?u MASP t?n t?i) b?ng c√°ch c?ng d?n v?i s? l??ng nh?p
    UPDATE SANPHAM
    SET SLSP = SLSP + v_sl_nhap
    WHERE MASP = :NEW.MASP;

    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            NULL; -- B? qua n?u MASP kh√¥ng t?n t?i trong SANPHAM
END;
/

------------------------------

--- Proceudre

CREATE OR REPLACE PROCEDURE GET_DISCOUNT_AND_VALUE (
    p_masp IN VARCHAR2,
    p_makh IN VARCHAR2,
    p_soluong IN NUMBER,
    p_chietkhau OUT FLOAT,
    p_trigia OUT FLOAT
) AS
    v_giaban FLOAT := 0;
    v_chietkhau FLOAT := 0; -- ??t m?c ??nh chi?t kh?u l√† 0
    v_soluongton INT := 0;
BEGIN
    -- L?y gi√° b√°n v√† s? l??ng t?n kho c?a s?n ph?m
    BEGIN
        SELECT GIABAN, SLSP INTO v_giaban, v_soluongton FROM SANPHAM WHERE MASP = p_masp;
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            v_giaban := 0;
            v_soluongton := 0;
    END;

    IF p_soluong > v_soluongton THEN
        RAISE_APPLICATION_ERROR(-20001, 'S? l??ng ??t h√†ng l?n h?n s? l??ng t?n kho');
    END IF;
    -- Ki?m tra n?u kh√°ch h√†ng kh√¥ng ph?i l√† kh√°ch h√†ng l? (MAKH = 'KH000')
    IF p_makh != 'KH000' THEN
        -- L?y chi?t kh?u c?a m√£ khuy?n m?i n?u c√≥ v√† n?u khuy?n m?i ?ang c√≥ hi?u l?c
        BEGIN
            SELECT NVL(MAX(CHIETKHAU), 0)
            INTO v_chietkhau
            FROM KHUYENMAI
            WHERE MASP = p_masp
            AND TO_DATE(SYSDATE,'DD-MON-YY') BETWEEN NGAYBD AND NGAYKT;
        EXCEPTION
            WHEN NO_DATA_FOUND THEN
                v_chietkhau := 0; -- Kh√¥ng c√≥ khuy?n m√£i h?p l?
        END;
    ELSE
        -- N?u l√† kh√°ch h√†ng l?, kh√¥ng √°p d?ng khuy?n m√£i
        v_chietkhau := 0;
    END IF;

    -- T√≠nh tr? gi√° sau khi √°p d?ng chi?t kh?u
    p_trigia := p_soluong * v_giaban * (1 - v_chietkhau);

    -- G√°n chi?t kh?u v√†o tham s? OUT
    p_chietkhau := v_chietkhau;
EXCEPTION
    WHEN OTHERS THEN
        RAISE; -- X? l√Ω l?i n?u c?n thi?t
END;
/


----
CREATE OR REPLACE PROCEDURE GET_NEWEST_MAHD (
    p_new_mahd OUT VARCHAR2
) AS
BEGIN
    SELECT MAX(MAHD) INTO p_new_mahd FROM HOADON;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        p_new_mahd := NULL;
END;
/

---
CREATE OR REPLACE PROCEDURE INSERT_CTHD(
    p_MAHD IN VARCHAR2,
    p_MASP IN VARCHAR2,
    p_MAKM IN VARCHAR2,
    p_TRIGIA IN FLOAT,
    p_SOLUONG IN INT
)
IS
BEGIN
        INSERT INTO CTHD (MAHD, MASP, MAKM, SL, TRIGIA)
        VALUES (p_MAHD, p_MASP, p_MAKM, p_SOLUONG, p_TRIGIA);
        -- Tr? s? l??ng t?n kho
        UPDATE SANPHAM SET SLSP = SLSP - p_SOLUONG WHERE MASP = p_MASP;

END;
/

---
CREATE OR REPLACE PROCEDURE INSERT_DOANHTHU (
    p_NGAYLAP DATE,
    p_TONGDT FLOAT
) IS
BEGIN
    INSERT INTO DOANHTHU (NGAYLAP, TONGDT)
    VALUES (p_NGAYLAP, p_TONGDT);
END;
/

---
CREATE OR REPLACE PROCEDURE UPDATE_TONG_HOA_DON(
    p_MAHD IN VARCHAR2,
    p_TONGDT IN FLOAT
)
IS
BEGIN
    UPDATE HOADON
    SET TONGDT = p_TONGDT
    WHERE MAHD = p_MAHD;

    COMMIT;
    DBMS_OUTPUT.PUT_LINE('T?ng tr? gi√° c?a h√≥a ??n ' || p_MAHD || ' ?√£ ???c c?p nh?t th√†nh c√¥ng.');
EXCEPTION
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('L?i: ' || SQLERRM);
        ROLLBACK;
END;
/
CREATE OR REPLACE PROCEDURE UPDATE_TONGDT
IS
    CURSOR cur_hd IS
        SELECT MAHD 
        FROM HOADON 
        WHERE MAHD BETWEEN 'HD001' AND 'HD075';

    v_tongdt FLOAT;
BEGIN
    FOR r_hd IN cur_hd LOOP
        -- T√≠nh t?ng tr? gi√° t? b?ng CTHD cho h√≥a ??n hi?n t?i
        SELECT SUM(TRIGIA)
        INTO v_tongdt
        FROM CTHD
        WHERE MAHD = r_hd.MAHD;

        -- C?p nh?t t?ng doanh thu trong b?ng HOADON
        UPDATE HOADON
        SET TONGDT = v_tongdt
        WHERE MAHD = r_hd.MAHD;

        DBMS_OUTPUT.PUT_LINE('Updated MAHD: ' || r_hd.MAHD || ' with TONGDT: ' || v_tongdt);
    END LOOP;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        DBMS_OUTPUT.PUT_LINE('No data found for one or more MAHD.');
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error: ' || SQLERRM);
END;
/

SET SERVEROUTPUT ON
BEGIN
    UPDATE_TONGDT;
END;

.

